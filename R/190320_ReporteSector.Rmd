---
title: "Censo Inmobiliario de Bogotá - 2019"
output:
  pdf_document:
    latex_engine: xelatex
    fig_caption: yes
    keep_tex: yes
fontsize: 12pt
geometry: margin=2cm
classoption: landscape
header-includes:
  - \usepackage{pdfpages}
  - \usepackage{float}
---

```{r global_options, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'H')
```


```{r, echo=FALSE,warning=FALSE}
rm(list=ls())


for (p in c("classInt","corrplot","flexdashboard","d3heatmap","DT","factoextra","FactoMineR","foreign","ggplot2","gridExtra","heatmaply","Hmisc","knitr","leaflet","maps","maptools","NbClust","openxlsx","pander","plotly","raster","RColorBrewer","reshape2","rgdal","rgeos","RPostgreSQL","scales","sf","spatstat","spdep","stringr","VIM","viridis","pander","data.table","bit64","staplr","gdata","tmap","grid","png","ggmap","rosm","mapview","devtools","webshot")) {

  if (!requireNamespace(p, quietly = TRUE))
    install.packages(p)
  suppressMessages(library(p, character.only = TRUE))
}

```

## Resultados en Bogotá

En el desarrollo del proceso de actualización del Censo Inmobiliario de Bogotá para la vigencia 2019 se contabilizaron 2.643.666 predios, el área construida alcanzó los 287,3 millones de metros cuadrados y la ciudad pasó de tener un valor catastral total de \$590,6 billones de pesos en 2018 a \$623,8 billones en 2019. Estas cifras evidencian un crecimiento inmobiliario de la ciudad del 2,18% del total de predios, un incremento del 1,44% del total de área construida y un crecimiento del 5,62% en valor catastral total. La siguiente gráfica resumen por Localidad de los datos del CIB 2018.


```{r fig1, echo=FALSE, out.width = "100%",fig.pos="H"}

#knitr::include_graphics("D:/Contenedor/Reporte/TablaPredios.png")
#![Cambios en el número de predios y área construida](E:/Reporte/TablaPredios.png){height=4cm}

```

## Resultados en el sector

```{r DAT, include= FALSE}
CODSECTOR<-"008520"
NOM_SECTOR<-"BOSQUE DE PINOS"
```

A continuación se presentan los resultados específicos del Sector Catastral **`r paste(CODSECTOR,NOM_SECTOR,sep="-")`**

 

### Generalidades del Sector

```{r CargueSector, include= FALSE}

Sectorshp<-st_read("E:/Catastro/datos/Reporte/Sector4326.shp")
MZ<-st_read("E:/Catastro/datos/Reporte/Manzana4326.shp")

#Predios<-read.table("PrediosCoords.txt",sep=";",dec = ",",header=TRUE,stringsAsFactors = FALSE)

#Predios$BARMANPRED<-paste0(str_pad(Predios$CODIGO_BAR, 6, pad = "0"),str_pad(Predios$CODIGO_MAN, 3, pad = "0"),str_pad(Predios$CODIGO_PRE, 3, pad = "0"))

PREDIOS<-st_read("E:/Catastro/datos/Reporte/Predios2019SHD4326.shp")
PREDIOS$BARMANP<-as.character(PREDIOS$BARMANP)
PREDIOS$var_avaluo=PREDIOS$DIFEREN/PREDIOS$AVLO_2018*100
pred<-PREDIOS[startsWith(PREDIOS$BARMANP,CODSECTOR), c("BARMANP","CHIP","CODG_BA","LOCALID","ESTRATO","DESTINO","AREA_CO","AVLO_2019","AVLO_2018","var_avaluo")]

SECTOR<-Sectorshp[Sectorshp$SECSECT_ID == CODSECTOR,3]
MZSECTOR<-MZ[MZ$MANSECT_ID == CODSECTOR,c("MANMANZ_ID")]
bbox <- st_bbox(pred) %>% as.vector()
#\includepdf[pages=-,nup=5,pagecommand={}]{D:/Contenedor/Barrios/INFOSECTOR.pdf}

```

```{r Cargue, include= FALSE}
#pal <- brewer.pal(4, "RdYlGn")
#pal <- colorRampPalette(pal)
#palData <- classIntervals(Trans$Porcentaje, n=4, style="fixed",fixedBreaks=c(0.01,90,100,max(Trans@data$Porcentaje,na.rm = TRUE)))
#Trans$colors <- findColours(palData, pal(100))
#factpal <- colorFactor(c('#969696','#238443'), MPIOSIni$INICIO)
#map <- leaflet(data=pred) %>%
  ## Base group: default OpenStreetMap map tiles
  #addProviderTiles("OpenStreetMap.Mapnik") %>%  fitBounds(bbox[1], bbox[2], bbox[3], bbox[4])%>%
  ## Overlay groups
  #addMarkers(clusterOptions = markerClusterOptions())%>%
  #addCircleMarkers(data=pred,radius = 2 ,stroke = FALSE, fillOpacity = 1, color = "#525252") %>%
  #addPolylines(data = DPTOS_lin, stroke = TRUE, color = "#252525",opacity = 1, weight= 1) %>%
  #addPolygons(data = MZSECTOR)
  ## Layers control

#addLayersControl(overlayGroups = c("Requerimientos a CONAL","Capital departamental", "Municipios Fase 2"),

    #options = layersControlOptions(collapsed = FALSE))%>%
  # Add legend
  #addLegend(pal = factpal, values = MPIOSIni$INICIO, opacity = 0.7, title = 'Estado   inicio',position = "bottomleft")

#saveWidget(map, "D:/Contenedor/DatosGeo/Predios2019SHD/temp.html", selfcontained = FALSE)



m <- mapview(list(SECTOR, MZSECTOR))

## without creation of above folder

print(m@map)
#htmlwidgets::saveWidget(m@map,file = paste0(getwd(), "/map.html"),selfcontained = TRUE)
#webshot(paste0(getwd(), "/map.html"), file = paste0(getwd(), "/map.png"), cliprect = "viewport")
```

```{r fig2, echo=FALSE, out.width = "100%",fig.pos="H"}
knitr::include_graphics(paste0(getwd(), "/map.png"))
#![Cambios en el número de predios y área construida](E:/Reporte/TablaPredios.png){height=4cm}
```

## Resultados del Predio

El predio presenta las siguientes características para la vigencia 2019:

```{r kable, echo=FALSE, message=FALSE, results='asis'}
#kable(t(pred), digits=2)
#,col.names = c("Valor")
```

 

 

 


