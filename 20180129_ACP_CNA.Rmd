---
title: "Análisis de Componentes Principales de la información del Censo Nacional Agropecuario (DANE 2013 - 2014) "
author: "Diana Galindo, Javier Jácome y Aníbal Montero"
date: "26 de Diciembre de 2017"
output:
  html_document:
    toc: true
    toc_depth: 2
    theme: flatly
    highlight: haddock
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
subtitle: Informe técnico
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Instalación de paquetes.

Se instalan los paquetes necesarios para realizar el análisis y diferentes herramientas de visualización.

```{r, results="hide", message=FALSE, warning=FALSE}
# vector con paquetes a cargar
paquetes<-c("ade4","Amelia","corrplot","factoextra","FactoMineR","foreign","ggplot2","gridExtra","Hmisc","RColorBrewer","reshape2","RPostgreSQL","knitr","openxlsx","NbClust","DT","d3heatmap","heatmaply","sf")
# vector con los paquetes no instalados
instalaciones<-paquetes[!paquetes %in% installed.packages()]
# iteración para descargar los paquetes sin instalar
for(libs in instalaciones) install.packages(libs)
# carga de paquetes
sapply(paquetes,require,character=TRUE)

# Cambiar según ubicación de librería Rtools en el equipo de trabajo
Sys.setenv("R_ZIPCMD"='C:/Rtools/bin/zip.exe') 
```


# 2. Importación de datos.

El proceso para consolidar los datos por vereda y la selección temática de variables se explica en detalle en el [documento técnico del estudio] (\\dg_est103\INVESTIGACION\ESTUDIOS_POST_CNA\DOCUMENTOS\Desarrollo\r003_Doc_Result_EstPostCensal_CNA_3.docx). En este paso se importa el objeto que almacena los datos en un archivo de extensión _rda_ y se renombran las variables para facilitar su visualización. La tabla muestra el nombre original y el asignado para el análisis en R.

```{r, message=FALSE}
# Del Script 20171220 se toma el objeto "resultado"
load(file = "E:/R/resultado.rda")
```

```{r, echo=FALSE}
#Almacenando los nombres originales del objeto resultado
nom_ant<-names(resultado)

#Renombrando variables (Alias) para ACP
names(resultado)<-c("cod_vereda","s1_tot_upas","r_maq","t_maq","p_maq","r_s_cred","t_s_cred","p_s_cred","r_en_agro","t_en_agro","p_en_agro","t_tr_perm","t_trper_hogp","p_trper_hogp","r_tr_col","t_tr_col","p_tr_col","r_ten","t_t_prop","t_t_arr","t_t_otros","t_ten_col","p_t_prop","p_t_arr","p_t_otros","p_ten_col","r_accH2O","t_AcH2O","p_AcH2O","ar_cagroind","ar_semb","t_ar_uso_agro","t_ar_pastos","t_ar_agricola","t_ar_InfAgric","t_ar_rastrojo","ar_monoc","p_ar_pastos","p_ar_agricola","p_ar_InfAgric","p_ar_rastrojo","p_cagroind","p_monoc","t_viv_oc","m_vivxupa","r_afsalud","t_afsalud","p_afsalud","r_dforz","t_dforz","p_dforz","t_asist","r_asist","p_asist","t_mayo15","t_analf","p_analf","t_UAutoc","t_UTruequeVL","t_UVentaM","t_UGranM","p61_rta","p_UAutoc","p_UTruequeVL","p_UVentaM","p_UGranM","r_usoSRiego","t_usoSRiego","ProductResi","p_usoSRiego","m_escolar","p_muj")

# Detalle
det<-c("Código de vereda",
"Total de UPAS",
"Total de UPAS que respondieron a pregunta 117",
"Total de UPAS que cuentan con maquinaria",
"Proporción de UPAS que cuentan con maquinaria",
"Total de UPAS que respondieron a la pregunta 136",
"Total de UPAS que solicitaron crédito",
"Proporción de UPAS que solicitaron crédito",
"Total de UPAS que respondieron a la pregunta 133",
"Total de UPAS que cuentan con energía agropecuaria",
"Proporción de UPAS que cuentan con energía agropecuaria",
"Total de trabajadores permanentes",
"Total de trabajadores permanentes por hogar productor",
"Proporción de trabajadores permanentes por hogar productor",
"Total de UPAS que respondieron a la pregunta 141",
"Total de UPAS que son trabajadas de forma colectiva",
"Proporción de UPAS que son trabajadas de forma colectiva",
"Total de UPAS que respondieron a la pregunta 39",
"Total de UPAS que respondieron a la opción 'Propia' en la pregunta 39",
"Total de UPAS que respondieron a la opción'Arriendo' en la pregunta 39",
"Total de UPAS que respondieron a la opción 'Por usufructo','Comodato','' en la pregunta 39",
"Total de UPAS que respondieron a la opción 'Colectiva' en la pregunta 39",
"Proporción de UPAS en donde residen los propietarios del predio",
"Proporción de UPAS que son arrendadas",
"Proporción de UPAS que son para usufructo..",
"Proporción de UPAS que presentan tenencia colectiva",
"Total de UPAS que respondieron a la pregunta 124",
"Total de UPAS que cuentan con acceso a agua (omitiendo agua lluvia y.",
"Proporción de UPAS que cuentan con acceso a agua (omitiendo agua lluvia y.",
"Total de área sembrada con cultivos agroindustriales (Has)",
"Total de área sembrada (Has)",
"Área total en uso agropecuario (Has)",
"Total de área de pastos (Has)",
"Total de área de uso agrícola (Has)",
"Total de área con infraestructura agroindustrial (Has)",
"Total de área con rastrojo (Has)",
"Total de área con monocultivos (Has)",
"Proporción de área en pastos",
"Proporción de área agrícola",
"Proporción de área en infraestructura agropecuaria",
"Proporción de área en rastrojo",
"Proporción de área en cultivos agroindustriales",
"Proporción de área en monocultivos",
"Total de viviendas ocupadas",
"Promedio de viviendas por UPA",
"Total de UPAS que respondieron a la pregunta 176",
"Total de personas que se encuentran afiliados al sistema de salud",
"Proporción de personas que se encuentran afiliados al sistema de salud",
"Total de UPAS que respondieron a la pregunta 179",
"Total de.. desplazamiento o abandono forzado",
"Proporción de personas que ..",
"Total de UPAS que recibieron al menos una vez asistencia o asesoría técnica",
"Total de UPAS que respondieron a la pregunta 135",
"Proporción de UPAS que recibieron al menos una vez asistencia o asesoría técnica",
"Total de personas mayores de 15 años",
"Total de personas mayores de 15 años que son analfabetas",
"Proporción de personas mayores de 15 analfabetas",
"Total de UPAS que respondieron a la opción 'Autoconsumo' en la pregunta 61",
"Total de UPAS que respondieron a la opción 'Trueque o venta' en la pregunta 61",
"Total de UPAS que respondieron a la opción 'Venta a mercado' en la pregunta 61",
"Total de UPAS que respondieron a la opción 'Venta a gran mercado' en la pregunta 61",
"Total de UPAS que respondieron a la pregunta 61",
"Proporción de UPAS con autoconsumo",
"Proporción de UPAS con trueque o venta",
"Proporción de UPAS con venta a mercado",
"Proporción de UPAS con venta a gran mercado",
"Total de UPAS que respondieron a la pregunta 52",
"Total de UPAS que usan sistemas de riego",
"Total de productores residentes",
"Proporción de UPAS que usa sistemas de riego",
"Promedio de años de escolaridad de los residentes mayores de 15 años",
"Proporción de mujeres")

nmcols<-cbind(nom_ant,colnames(resultado),det)
datatable(nmcols, colnames=c("Inicial","Alias","Detalle (por vereda)"),options = list(pageLength = 20),caption = "Nombres iniciales de variables y alias para análisis")

```

El objeto "resultado" almacena todas las variables tomadas y calculadas para el análisis de información del Censo Nacional Agropecuario. El primer filtro remueve las variables originales con las que se calcularon las tasas y deja solamente aquellas que se van a incorporar en el ACP. El objeto que almacena los datos a utilizar en el ACP se llama _filtro1_.

## 2.1. Depuración de datos

Con el código presentado a continuación, primero se filtran las variables a entrar en el análisis, se establece si tiene datos faltantes y finalmente se genera un objeto que almacena los datos sin las observaciones faltantes ("filtro2").

```{r, message=FALSE}
#str(resultado)
# Filtro 1: Variables escogidas (Proporcións)
filtro1<-resultado[,c(1,5,8,11,12,14,17,23:26,29,31,38:43,45,48,54,57,63:66,69:72)]
#names(filtro1)
#dim(filtro1)
#getwd()
#write.dbf(filtro1,"Filtro1.dbf")

# Generando gráfico de datos faltantes
etq<-vector(mode="character", length=dim(filtro1)[1])
sapply(filtro1, function(x) sum(length(which(is.na(x)))))
par(oma=c(1,0,0,0))
missmap(filtro1, rank.order=T,col=c("#b2182b", "grey"),x.cex = 0.7, 
	y.cex = 0.2, main = "Datos faltantes", legend = FALSE,cex.main=0.7,
	y.labels=etq)
#dim(filtro1[is.na(filtro1$p_AcH2O) & is.na(filtro1$m_escolar),])# Total datos faltantes

# Removiendo las veredas con datos faltantes
colscor2=brewer.pal(9, 'Greens')
mapa<-subset(filtro1,complete.cases(filtro1))
filtro2<-subset(filtro1,complete.cases(filtro1))
#str(filtro2)
rownames(filtro2)<-filtro2$cod_vereda
#head(filtro2)
filtro2<-filtro2[,c(2:31)]# Removiendo el cod_vereda
#str(filtro2)
#summary(filtro2)

#library(VIM)
#aggr_plot <- aggr(filtro2[,c(2:30)], col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(data), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))

```
El conjunto de datos inicial (filtro1) cuenta con información de 30 variables y 30.138 individuos (veredas). Presenta 1.135 datos faltantes en la variable "promedio de años de escolaridad", 532 en la variable "Porcentaje de UPAS con acceso a Agua" y 366 veredas presentan datos faltantes en ambas variables. Los datos faltantes corresponden a las veredas donde no se respondieron las preguntas asociadas a las variables. Al considerar que el total de veredas con datos faltantes (1.301) representan el 4.31% del total de datos iniciales, se remueven dichas veredas para generar el ACP. 

La base de datos que se utiliza para el Análisis representa información de 28.837 veredas y 30 variables.  El mapa muestra en color verde las veredas que fueron incluidas del ACP por tener y en gris que no fueron incluidas. Ésta condición puede darse, entre otras razones, porque este estudio considera solo las UPA y no las UPNA.

```{r, message=FALSE}

all_shape_addresses <- list.files(path="E:/R/", pattern = ".shp", full.names =T, recursive = TRUE)
files_list <- lapply(all_shape_addresses, st_read)
a<-files_list[[3]]
class(a)
attr(a, "sf_column")
print(a[9:15], n = 3)
plot(a[,1], col = 'grey')


merged = merge(a, mapa,  by.x= "CODIGO_VER", by.y="cod_vereda")
factpal <- colorFactor(magma(10), a$CODIGO_VER)
leaflet(data = merged[,4]) %>% addProviderTiles("OpenStreetMap.BlackAndWhite") %>% 
        setView(-73.800,4.500,zoom = 8) %>% 
        addPolygons(fillColor = ~factpal(merged[,3]), stroke = FALSE,
                    popup = paste(merged[,3],"\n",merged[,6]))


VDAS<-readOGR(dsn="E:/VEREDAS_V27",layer="VeredaSimp.shp",stringsAsFactors=FALSE,use_iconv=TRUE,encoding="UTF-8")
#str(VDAS@data)
VDAS@data<-as.data.frame(VDAS@data[,c(1:6,12)])


VDAS@data<-as.data.frame(VDAS@data[,c(1:6,12)])



leaflet(data = VDASPrueba) %>% addProviderTiles("OpenStreetMap.BlackAndWhite") %>% 
        setView(-73.800,4.500,zoom = 8) %>% 
        addPolygons(fillColor = ~factpal(CODIGO_VER), stroke = FALSE,
                    popup = paste(VDAS$CODIGO_VER,"\n",VDAS$NOMBRE_VER))



```


# 3.Análisis preliminar 

Para iniciar el Análisis, se generan los histogramas de las variables. Estos histogramas muestran la distribución de los datos por variable. La línea de color azul muestra la mediana de los datos y la función de densidad de los datos de forma sombreada.

```{r, message=FALSE}
a<-names(filtro2)
a<-as.list(a)
fun02<-function(i){index=grep(i,names(filtro2))
                   bw <- nclass.Sturges(filtro2[,index]) # Freedman-Diaconis
                   nm=paste0(i)
                   assign(paste("g",i,sep=""),
                   ggplot(filtro2, aes(filtro2[,index])) +  
                   geom_histogram(bins = bw,aes(y=..density..), fill="#de2d26") +
                   geom_density(alpha=.35, fill="#08519c",color = NA)  +
                   geom_vline (aes(xintercept=median(filtro2[,index])),
            color="#08519c", size=1) + 
                   labs(title=nm, x=NULL, y="UPAS")) +
                   theme(plot.title = element_text(size = rel(0.7),face ="bold",hjust = 0.5),
                        axis.title.y = element_text(size = rel(0.4)),
                        axis.text = element_text(size = rel(0.4)))
                   }
Histos<-lapply(a,fun02)
do.call(grid.arrange, Histos)
```
De los histogramas podemos notar el comportamiento de los valores de las variables que entran al análisis:

1)  Existe una alta proporción de UPAS por vereda con tenencia propia. De la misma forma,éstos nos muestran que es común encontrar valores altos en la proporción de UPAS con ventas a mercados y grandes mercados y encontrar que la mayoría de veredas presenta una alta proporción de afiliados al sistema de salud.

2)  Las veredas presentan un rango amplio de valores en variables que describen la proporción de trabajadores permanentes por hogar productor, de las UPAS con autoconsumo y del uso de sistemas de riego.

5)  La proporción de las áreas de pastos, de uso agrícola y de rastrojo es complementaria. Cada una de estas variables presentan una proporción media alrededor del 25% por vereda.

3) En el promedio de viviendas por UPA, el total de trabajadores permanentes y la proporción de veredas con trabajo colectivo se encuentran predominantemente valores bajos pero pueden presentar valores altos atípicos. De igual forma se presenta este comportamiento en la proporción tenencia por arriendo, colectiva y otros tipos de tenencia y el fenómeno puede ser  muy marcado en las variables: área sembrada, área en infraestructura agropecuaria y total de productores residentes.

4)  El porcentaje de las UPAS por vereda que usa maquinara tiende a ser bajo, así como el de energía agropecuaria, solicitud de crédito y asistencia técnica pero algunas veredas pueden presentar un alto porcentaje. En términos generales, este comportamiento se replica en la proporción de cultivos agroindustriales.

7)  Finalmente, el promedio de años de escolaridad a nivel nacional está cercano a los 5 y encontrar veredas donde el promedio de años de escolaridad sea mayor a 10 años no es común aunque en algunos casos se puede dar. Por su parte, la proporción de analfabetismo es baja en general aunque puede llegar a alcanzar el 50% o valores superiores en casos aislados.

9)El dato medio de las veredas analizadas en este estudio presentan una proporción de mujeres cercana al 50%.

8) Para el caso de la proporción de área en monocultivos  mayoritariamente toma valores bajos, pero se tambien se pueden encontrar valores el área de la vereda es usada de esta manera.

También se calculan las correlaciones entre las variables para verificar si algunas de ellas se explican entre sí. La siguiente gráfica muestra una ilustración de la matriz de correlaciones (Para ver el coeficiente de correlación pase el mouse por la celda correspondiente).



```{r, message=FALSE}
cor_org<-cor(filtro2)

upper<-cor_org
upper[upper.tri(cor_org)]<-0
upper<-as.data.frame(upper)

d3heatmap(round(upper,2),symm=FALSE,colors="RdBu",revC=TRUE,dendrogram="none", main="Matriz de correlaciones b1",symbreaks = TRUE)


heatmaply(round(upper,2),scale_fill_gradient_fun = ggplot2::scale_fill_gradient2(low = "#67001f", high = "#053061", midpoint = 0),dendrogram="none",hide_colorbar = TRUE)

#, margins = c(40, 130), 
#          scale_fill_gradient_fun = ggplot2::scale_fill_gradient2(low = "blue", high = #"red", midpoint = 200, limits = c(0, 500)))

```




# 4. Análisis de Componentes Principales (ACP)

Se calculan los componentes principales del conjunto de datos.
```{r, message=FALSE}
#Componentes regulares b1
pc1<-PCA(filtro2, scale.unit=TRUE,ncp=15,graph=FALSE)
```

Se generan a continuación los valores propios, el porcentaje de varianza retenida por cada componente y el gráfico de sedimentación (_Scree Plot_). Hay varios "codos" en el gráfico de barras, entre los componentes 2 y 3, entrel 4 y el 5 y entre el 6 y el 7.Además,  

```{r, message=FALSE}
fviz_eig(pc1,addlabels = TRUE,xlab="Componentes",ylab="% de varianzas explicadas por el ACP")
datatable(round(pc1$eig,3), options = list(pageLength = 10),
          caption = "Valores propios y varianza explicada pca b1")
```

Representación de las variables por componente

```{r, message=FALSE}
corrplot(pc1$var$cos2,is.corr=FALSE,number.cex = 0.5,tl.col="gray31",tl.cex=0.5,
	   cl.ratio=0.30,cl.cex=0.35, cl.align="c",mar=c(0,1,1,0),title="Calidad de representación (variables)",cex.main=0.7,col=colscor2)

corrplot(pc1$var$cor,cex.main=0.7,method = c("square"),number.cex = 0.5,tl.cex=0.7,tl.col="gray31",cl.align="c",tl.offset = 0.1,col = rev(brewer.pal(5, "RdBu")))



```

Círculo de correlaciones del primer plano factorial

```{r, message=FALSE}
#Componentes regulares b1
fviz_pca_var(pc1,col.var="cos2",repel=TRUE,labelsize = 3,gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),title= "Círculo de Correlaciones (Componentes 1 y 2)", legend.title= paste0("Cos2",'\n',"(var)"))
 #gráfico de individuos
#fviz_pca_biplot(pc1,axes=c(1,2), ggtheme = theme_minimal(),labelsize=3,col.ind = "gray67",geom.var = c("point", "text"),pointshape = 19)

```

Calidad general de representación de las variables en el modelo elegido


```{r}
colscor3=brewer.pal(9, 'Greens')
corrplot(pc1$var$cos2[,1:6],is.corr=FALSE,number.cex = 0.5,tl.col="gray31",tl.cex=0.5,
	   cl.ratio=0.25,cl.cex=0.5, cl.align="l",mar=c(0,0,1.5,0),title="Representación de las variables",cex.main=0.7,col=colscor3)

corrplot(pc1$var$cor[,1:4],cex.main=0.7,method = c("square"),number.cex = 0.5,tl.cex=0.7,tl.col="gray31",cl.align="c",tl.offset = 0.1,col = rev(brewer.pal(5, "RdBu")))
```
El anterior diagrama representa de forma comparativa la calidad de la representación de cada una de las variables de análisis en cada uno de los seis factores del modelo de componentes principales, la intensidad del color y el tamaño de los círculos está relacionado al porcentage de inercia de la variable que fue retenida por el factor [Pardo et. al. 2009], de esta forma y en primera medida se puede asociar cada una de las variables a los diferentes factores latentes del modelo que las están explicando.

```{r}
x1 <- t(cumsum(as.data.frame(t(pc1$var$cos2[,1:4]))))
x1 <- as.data.frame(x1[order(-x1[,4]),])
x1$variable <- factor(rownames(x1), levels=rownames(x1)[order(-x1$Dim.4)] )


#barplot(x,las=2,cex.lab=0.5)

p <- ggplot(data=x1, aes(x=variable, y=Dim.4)) +
  geom_bar(stat="identity", fill="#E7B800") +
  scale_y_continuous(labels = scales::percent) +
  theme(
    axis.text.x = element_text(angle = 90, hjust = 1),
    axis.title.x= element_blank()) + labs(title = "Calidad de representación de las variables en el ACP escogido", y = "Calidad")
p
```

El anterior resumen muestra la calidad de la representación de las variables en el modelo elegido de seis factores, estos porcentajes se basan en las estadísticas de calidad de representación por factor mostradas en el diagrama de círculos tpermite identificar las variables que tienen menor relación lineal con el conjunto general de variables. Por ejemplo, tatatá. cabe anotar que, para el objetivo del análisis, se asume que los factores escogidos son el resumen general de las 30 variables de análisis.

Calidad por componente


```{r, size ='tiny'}
listpl<-list()
for (i in 1:4){
                tmpnm<-paste("varcontComp",i,sep="")
                assign(tmpnm,fviz_contrib(pc1, choice = "var", axes = i, top = 14, fill = "#E7B800", color = "#E7B800",font.tickslab = c(7), xtickslab.rt=90)+labs(title = paste("Contribución componente",i), x = "", y = ""))
		    listpl[[tmpnm]] <- get(tmpnm)
              }
do.call(grid.arrange, listpl)
```

El anterior esquema nos muestra en cada gráfico la organización de las variables por su contribución en inercia a cada componente, resalta las variables que contribuyen a la inercia del componente por encima del promedio por variable (es decir 1 dividido entre 8 variables: 3.57% ). Cabe mencionar que el resto de variables que no se encuentran incluidas dentro de los grupos de mayor contribución se pueden interpretar también a la luz del modelo de componentes, lo cual es su objetivo dentro de la investigación.


```{r}
cont1 <- pc1$var$contrib[order(-pc1$var$contrib[,1]),1]
cont1 <- cont1[cont1>(100/29)]
print("Componente 1")
print(cont1,digits = 2)

cont2 <- pc1$var$contrib[order(-pc1$var$contrib[,2]),2]
cont2 <- cont2[cont2>(100/29)]
print("Componente 2")
print(cont2,digits = 2)

cont3 <- pc1$var$contrib[order(-pc1$var$contrib[,3]),3]
cont3 <- cont3[cont3>(100/29)]
print("Componente 3")
print(cont3,digits = 2)

cont4 <- pc1$var$contrib[order(-pc1$var$contrib[,4]),4]
cont4 <- cont4[cont4>(100/29)]
print("Componente 4")
print(cont4,digits = 2)

```

Los anteriores son los porcentajes de contribución a la inercia del componente con una inercia superior a la contribución promedio por variable.

Círculos de correlaciones de todos los planos
```{r, size ='tiny'}
## Circulos de correlaciones
listplan<-list()
m <- combn(1:4, 2)
colnames(m) <- letters[1:6]
colscor2=c("#00AFBB", "#E7B800", "#FC4E07")
for(i in 1:length(colnames(m))){
tmp<-m[,i]
nm<-paste0("plan",i)
assign(nm,
fviz_pca_var(pc1,axes = tmp,col.var="cos2",geom=c("point","text"),gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),repel=TRUE,labelsize = 3))
listplan[[nm]] <- get(nm)
print(listplan[[nm]])
}

```


Debido a que el modelo de componente principales tiene seis componentes, no es práctica la utilización de biplots para la interpretación de los resultados, al ser cuatro componentes se obliga a que se haga una lectura de 3 espacios factoriales de 3dsimensiones o a 6 planos factoriales de 2 dimensiones. Por esto se ha optado, para una mayor facilidad: tipificar, caracterizar y perfilar las variables dentro de cada componente con su lectura individual (tal y como en el análisis de Carlos).

Se exportan los resultados:
```{r}
#Exportar coordenadas por plano para variables y veredas

#coord.var<-pc1$var$coord
#coord.var<-cbind(coord.var,row.names(coord.var))
#colnames(coord.var)[dim(coord.var)[2]]<-c("nombvar")
#saveRDS(coord.var,"ACP_CoordVars.rds")
#save(coord.var,file="ACP_CoordVars.rda")

#coord.ind<-pc1$ind$coord
#coord.ind<-cbind(coord.ind,row.names(coord.ind))
#colnames(coord.ind)[dim(coord.ind)[2]]<-c("cod.vereda")
#saveRDS(coord.ind,"ACP_CoordInd.rds")
#save(coord.ind,file="ACP_CoordInd.rda")

#DatosxVereda<-cbind(filtro2,row.names(filtro2))
#colnames(DatosxVereda)[dim(DatosxVereda)[2]]<-c("cod.vereda")
#saveRDS(DatosxVereda,"ORG_DatosInd.rds")
#save(DatosxVereda,file="ORG_DatosInd.rda")

#getwd()
#write.xlsx(coord.ind, "coord_filas_ACPv6.xlsx")
#write.xlsx(coord.var, "coord_columnas_ACPv6.xlsx")
#write.xlsx(DatosxVereda,"DatosxVereda_ACPv6.xlsx")
```

 
# Referencias

* _Geometría euclidiana en estadística: métodos en ejes principales. Pardo, C.E.
  Consultado en: http://www.docentes.unal.edu.co/cepardot/docs/Conferencias/ACPgeometriaEuclidiana.pdf. Fecha: Noviembre de 2017.
  
* _Principal Component Methods in R: Practical Guide_. Kassambara A. Consultado en: http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/. Fecha: Noviembre de 2017.

